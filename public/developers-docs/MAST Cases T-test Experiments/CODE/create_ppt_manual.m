function create_ppt_manual()
    % Create PowerPoint presentation manually using COM automation
    
    try
        % Create PowerPoint application
        ppt = actxserver('PowerPoint.Application');
        ppt.Visible = 1;
        
        % Create new presentation
        presentation = ppt.Presentations.Add;
        
        % Get the presentation object
        pres = presentation;
        
        % Slide 1: Title Slide
        slide1 = pres.Slides.Add(1, 1); % ppLayoutTitle = 1
        slide1.Shapes.Title.TextFrame.TextRange.Text = 'HRS Parameter Analysis Results';
        
        % Add subtitle if possible
        if slide1.Shapes.Count > 1
            slide1.Shapes.Item(2).TextFrame.TextRange.Text = 'Investigation of Identical Values Across Experiments';
        end
        
        % Slide 2: Problem Statement
        slide2 = pres.Slides.Add(2, 2); % ppLayoutText = 2
        slide2.Shapes.Title.TextFrame.TextRange.Text = 'Problem Statement';
        slide2.Shapes.Item(2).TextFrame.TextRange.Text = sprintf(['• Initial observation: Many identical values across experiments\n'...
               '• Question: Are parameter variations working correctly?\n'...
               '• Investigation: Compare same study across different experiments\n'...
               '• Focus: First 4 experiments with varying WashOutUpper parameters\n'...
               '• Expected: Different parameter values should produce different results']);
        
        % Slide 3: Experiment Parameters
        slide3 = pres.Slides.Add(3, 2);
        slide3.Shapes.Title.TextFrame.TextRange.Text = 'Experiment Parameters';
        slide3.Shapes.Item(2).TextFrame.TextRange.Text = sprintf(['Parameter Variations (ADC parameters identical):\n\n'...
               'Exp001: WU=4.0,    PZ=850/1050/1200\n'...
               'Exp002: WU=2.5,    PZ=850/1050/1200\n'...
               'Exp003: WU=3.0,    PZ=850/1050/1200\n'...
               'Exp004: WU=3.5,    PZ=850/1050/1200\n\n'...
               'Expected Impact:\n'...
               '• WashOutUpper → DCE masks → HRS masks → All features except ADC_Prostate_Mean\n'...
               '• ADC PZ thresholds → ADC-based features (ADC_HRS1_Mean, ADC_HRS6_Mean)']);
        
        % Slide 4: Analysis Results
        slide4 = pres.Slides.Add(4, 2);
        slide4.Shapes.Title.TextFrame.TextRange.Text = 'Analysis Results Overview';
        slide4.Shapes.Item(2).TextFrame.TextRange.Text = sprintf(['✅ ADC_Prostate_Mean: 100%% identical (EXPECTED - not affected by parameters)\n\n'...
               '✅ HRS1_Volume: 68-94%% identical (GOOD - shows variation)\n'...
               '✅ HRS6_Volume: 62-92%% identical (GOOD - shows variation)\n'...
               '✅ HRS7_6_Ratio: 60-91%% identical (GOOD - shows variation)\n'...
               '✅ ADC_HRS1_Mean: 57-88%% identical (GOOD - shows variation)\n'...
               '✅ ADC_HRS6_Mean: 51-81%% identical (GOOD - shows variation)\n\n'...
               'Conclusion: Parameter variations ARE working correctly!']);
        
        % Slide 5: Root Cause Analysis
        slide5 = pres.Slides.Add(5, 2);
        slide5.Shapes.Title.TextFrame.TextRange.Text = 'Root Cause Analysis';
        slide5.Shapes.Item(2).TextFrame.TextRange.Text = sprintf(['Debugging Process:\n\n'...
               '1. Reviewed HRS Java code implementation\n'...
               '2. Traced DCEScore calculation\n'...
               '3. Analyzed patient MAST007 as example\n\n'...
               'Key Finding: DCEScore calculation explains similarities\n\n'...
               'DCEScore = (Math.max(Math.min(DCEFeatureSum, upper), lower) - lower) / (upper - lower)\n\n'...
               'When DCEFeatureSum values are similar, DCEScore becomes identical, leading to identical HRS features.']);
        
        % Slide 6: MAST007 Debug Example
        slide6 = pres.Slides.Add(6, 2);
        slide6.Shapes.Title.TextFrame.TextRange.Text = 'MAST007 Debug Example';
        slide6.Shapes.Item(2).TextFrame.TextRange.Text = sprintf(['Patient MAST007 Analysis:\n\n'...
               'WashOut = 4.0:  DCEFeatureSum = 6.536  → DCEScore = 1.0\n'...
               'WashOut = 2.5:  DCEFeatureSum = 3.26   → DCEScore = 1.0\n'...
               'WashOut = 3.0:  DCEFeatureSum = 3.26   → DCEScore = 1.0\n'...
               'WashOut = 3.5:  DCEFeatureSum = 3.26   → DCEScore = 0.9227\n\n'...
               'Result: Experiments 1,2,3 identical, Experiment 4 different\n\n'...
               'This explains why some patients show identical values across experiments 1-3 but differ in experiment 4.']);
        
        % Slide 7: Conclusions
        slide7 = pres.Slides.Add(7, 2);
        slide7.Shapes.Title.TextFrame.TextRange.Text = 'Conclusions';
        slide7.Shapes.Item(2).TextFrame.TextRange.Text = sprintf(['✅ Parameter variations are working correctly\n\n'...
               '✅ Identical values are explained by DCEScore calculation\n\n'...
               '✅ Some patients naturally have similar DCEFeatureSum values\n\n'...
               '✅ When DCEFeatureSum is similar, DCEScore becomes identical\n\n'...
               '✅ This leads to identical HRS features for those patients\n\n'...
               '✅ ADC_Prostate_Mean correctly shows no variation (not parameter-dependent)\n\n'...
               '✅ The system is functioning as designed']);
        
        % Slide 8: Recommendations
        slide8 = pres.Slides.Add(8, 2);
        slide8.Shapes.Title.TextFrame.TextRange.Text = 'Recommendations';
        slide8.Shapes.Item(2).TextFrame.TextRange.Text = sprintf(['For Future Analysis:\n\n'...
               '1. Document expected behavior: Some patients will have identical values\n\n'...
               '2. Focus on patients showing variation to assess parameter sensitivity\n\n'...
               '3. Consider DCEScore thresholds when designing experiments\n\n'...
               '4. Validate parameter ranges to ensure meaningful variation\n\n'...
               '5. Monitor ADC_Prostate_Mean separately (parameter-independent feature)\n\n'...
               '6. Use statistical analysis to identify parameter-sensitive patient subgroups']);
        
        % Save presentation
        savePath = 'C:\Users\tamer\Desktop\Mast Cases TTest experiments\CODE\HRS_Analysis_Results.pptx';
        pres.SaveAs(savePath);
        
        fprintf('Presentation saved to: %s\n', savePath);
        fprintf('Total slides created: %d\n', pres.Slides.Count);
        
        % Don't close automatically so user can see the result
        fprintf('PowerPoint presentation created successfully!\n');
        fprintf('Please close PowerPoint manually when done.\n');
        
    catch ME
        fprintf('Error creating presentation: %s\n', ME.message);
        fprintf('Error location: %s\n', ME.stack(1).name);
        fprintf('Line: %d\n', ME.stack(1).line);
        
        % Try to clean up
        try
            if exist('pres', 'var')
                pres.Close;
            end
            if exist('ppt', 'var')
                ppt.Quit;
            end
        catch
            % Ignore cleanup errors
        end
    end
end
